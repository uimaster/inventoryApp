<p-progressSpinner *ngIf="showLoader"></p-progressSpinner>
<app-reports-filter></app-reports-filter>

<p-panel header="PO Report" class="Tabledata" *ngIf="type=='po-report' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="8%">PO No</th>
                <th width="8%">PO Date</th>
                <th width="10%">Supplier</th>
                <th width="7%">Item Code</th>
                <th width="20%">Item Desc</th>
                <th width="5%">Item Qty</th>
                <th width="8%">Pending Qty</th>
                <th width="5%">Rate</th>
                <th width="5%">Amount</th>
                <th width="8%">Total Amount</th>
                <th width="8%">Due Date</th>
                <th width="8%">Status</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <td>{{report.pono}}</td>
                    <td>{{report.poDate | date:'dd/MM/yyyy'}}</td>
                    <td>{{report.supplierName}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemDesc}}</td>
                    <td>{{report.itemQty}}</td>
                    <td>{{report.pendingQty}}</td>
                    <td>{{report.itemRate}}</td>
                    <td>{{report.itemAmount}}</td>
                    <td>{{report.totalAmount}}</td>
                    <td>{{ formatDate(report.poDueDate)}}</td>
                    <td>
                        <span *ngIf="report.trstatus == 1"><i style="color:orange" class="fa fa-clock-o fa-2x"></i></span>
                        <span *ngIf="report.trstatus == 2"><i style="color:green" class="fa fa-check-square-o fa-2x"></i></span>
                    </td>
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>

<p-panel header="SO Report" class="Tabledata" *ngIf="type=='so-report' && sub_type=='order-summary' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="5%">Date</th>
                <th width="15%">DOC No</th>
                <th width="10%">Order Ref</th>
                <th width="5%">Due Date</th>
                <th width="5%">Despatch Date</th>
                <th width="15%">Customer Location</th>
                <th width="10%">Product Type</th>
                <th width="10%">TR Status</th>
                <th width="5%">PO No</th>
                <th width="5%">Box Nos</th>
                <th width="15%">Customer</th>
                <!-- <th width="10%">Amount</th> -->
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <td>{{report.soDate | date:'dd/MM/yyyy'}}</td>
                    <td>{{report.sono}}</td>
                    <td>{{report.commissionNO}}</td>
                    <td>{{report.soDueDate}}</td>
                    <td>{{report.despatchDate | date:'dd/MM/yyyy'}}</td>
                    <td>{{report.customerLocation}}</td>
                    <td>{{report.productType}}</td>
                    <td>{{report.trstatus}}</td>
                    <td>{{report.pono}}</td>
                    <td>{{report.boxNos}}</td>
                    <td>{{report.customerName}}</td>
                    <!-- <td>{{report.totalAmount}}</td>
                    <td>
                        <span *ngIf="report.trstatus == 1"><i style="color:orange" class="fa fa-clock-o fa-2x"></i></span>
                        <span *ngIf="report.trstatus == 2"><i style="color:green" class="fa fa-check-square-o fa-2x"></i></span>
                    </td> -->
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>

<p-panel header="SO Details Report" class="Tabledata" *ngIf="type=='so-report' && sub_type=='order-details' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%"  type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="5%">SR No</th>
                <th width="10%">PO No</th>
                <th width="9%">JOB NO</th>
                <th width="5%">BOX ID</th>
                <th width="5%">Code</th>
                <th width="20%">Description</th>
                <th width="3%">Qty</th>
                <th width="3%">UOM</th>
                <th width="10%">Location</th>
                <th width="5%">Date</th>
                <th width="5%">Due Date</th>
                <th width="5%">Rate</th>
                <th width="5%">Amount</th>
                <th width="15%">Customer</th>
                
                <!-- <th width="5%">Order No</th>
                <th width="3%">Length</th>
                <th width="5%">Order Amount</th>
                <th width="5%">Status</th> -->
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <td>{{(p - 1) * 10 + i +1}}</td>
                    <td>{{report.pono}}</td>
                    <td>{{report.jobno}}</td>
                    <td>{{report.boxid}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemDesc}}</td>
                    <td>{{report.itemQty}}</td>
                    <td>{{report.uom}}</td>
                    <td>{{report.customerLocation}}</td>
                    <td>{{report.soDate | date:'dd/MM/yyyy'}}</td>
                    <td>{{report.soDueDate}}</td>
                    <td>{{report.itemRate}}</td>
                    <td>{{report.itemAmount}}</td>
                    <td>{{report.customerName}}</td>

                   <!--  <td>{{report.sono}}</td>
                    <td>{{report.itemLength}}</td>
                    <td>{{report.totalAmount}}</td>
                    <td>
                        <span *ngIf="report.trstatus == 1"><i style="color:orange" class="fa fa-clock-o fa-2x"></i></span>
                        <span *ngIf="report.trstatus == 2"><i style="color:green" class="fa fa-check-square-o fa-2x"></i></span>
                    </td> -->
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>

<p-panel header="Despatch Details Report" class="Tabledata" *ngIf="type=='despatch-details-report' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="5%">Despatch Date</th>
                <th width="15%">DOC No</th>
                <th width="10%">PO No</th>
                <!-- <th width="5%">PO Date</th> -->
                <th width="5%">JOB NO</th>
                <th width="10%">Location</th>
                <th width="5%">Due Date</th>
                <th width="5%">Item Code</th>
                <th width="15%">Description</th>
                <th width="5%">Qty</th>
                <!-- <th width="5%">Stops</th> -->
                <th width="5%">UOM</th>
                <th width="5%">Length</th> 
                <th width="15%">Customer</th>
                
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <td>{{report.plDate | date:'dd/MM/yyyy'}}</td>
                    <td>{{report.plno}}</td>
                    <td>{{report.pono}}</td>
                    <!-- <td>{{report.poDate}}</td> -->
                    <td>{{report.jobno}}</td>
                    <td>{{report.customerLocation}}</td>
                    <td>{{report.dueDate}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemDesc}}</td>
                    <td>{{report.itemQty}}</td>
                    <!-- <td>{{report.itemStops}}</td> -->
                    <td>{{report.itemUOM}}</td>
                    <td>{{report.itemLength}}</td>
                    <td>{{report.customerName}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>

<p-panel header="Stock Summary" class="Tabledata" *ngIf="type=='stock-summary' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div ><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="5%">SNo</th>
                <th width="10%">Item Code</th>
                <th width="20%">Item Name</th>
                <th width="10%">OpBal</th>
                <th width="5%">GRN Qty</th>
                <th width="10%">Purchase Rtn</th>
                <th width="5%">Stock Issue Qty</th>
                <th width="10%">Sales Qty</th>
                <th width="10%">Closing Qty</th>
                <th width="10%">Closing Rate</th>
                <th width="10%">Closing Value</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <td>{{(p - 1) * 10 + i +1}}</td>
                    <td>
                        <a style="cursor: pointer;" (click)="openStockItemDetails(report.stockItemID)">{{report.itemCode}}
                        </a>
                    </td>
                    <td>{{report.itemName}}</td>
                    <td>{{report.opBalQty}}</td>
                    <td>{{report.grnQty}}</td>
                    <td>{{report.purchaseReturnQty}}</td>
                    <td>{{report.stockIssueQty}}</td>
                    <td>{{report.salesQty}}</td>
                    <td>{{report.closingQty}}</td>
                    <td>{{report.closingRate}}</td>
                    <td>{{report.closingValue}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>

<p-panel header="MSL Report" class="Tabledata" *ngIf="type=='msl-report' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="10%">SNo</th>
                <th width="20%">Item Code</th>
                <th width="30%">Item Name</th>
                <th width="20%">MSL Qty</th>
                <th width="20%">Closing Qty</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <td>{{i+1}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemName}}</td>
                    <td>{{report.mslQty}}</td>
                    <td>{{report.currentSTKQty}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>

<p-panel header="Sales Register" class="Tabledata" *ngIf="type=='sales-register' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    

    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="10%">SNo</th>
                <th width="10%">Invoice Number</th>
                <th width="10%">Invoice Date</th>
                <th width="20%">Customer Name</th>
                <th width="10%">Total Amount</th>
                <th width="10%">Commission No</th>
                <th width="10%">PO No</th>
                <th width="10%">EWayBillNo</th>
                <th width="10%">EwayBillDate</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <td>{{i+1}}</td>
                    <td>{{report.transactionNO}}</td>
                    <td>{{report.transactionDate|date:'dd/MM/yyyy'}}</td>
                    <td>{{report.customerName}}</td>
                    <td>{{report.totalAmount}}</td>
                    <td></td>
                    <td>{{report.pono}}</td>
                    <td>{{report.eWayBillNo}}</td>
                    <td>{{report.eWayBillDate|date:'dd/MM/yyyy'}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>


<p-panel header="GRN Register" class="Tabledata" *ngIf="type=='grn-register' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    

    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="10%">GRN No</th>
                <th width="10%">GRN Date</th>
                <th width="10%">Supplier</th>
                <th width="5%">Item Code</th>
                <th width="10%">Item Desc</th>
                <th width="5%">Order Qty</th>
                <th width="5%">Received Qty</th>
                <th width="5%">Rate</th>
                <th width="5%">Amount</th>
                <th width="5%">Total Amount</th>
                <th width="10%">PO No</th>
                <th width="10%">Inward No</th>
                <th width="10%">Inward Date</th>
                <th width="10%">Invoice  No</th>
                <th width="10%">Invoice  Date</th>
                <th width="10%">DC No</th>
                <th width="10%">DC Date</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <td>{{report.transactionNO}}</td>
                    <td>{{report.transactionDate|date:'dd/MM/yyyy'}}</td>
                    <td>{{report.supplierName}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemDesc}}</td>
                    <td>{{report.orderqty}}</td>
                    <td>{{report.itemQty}}</td>
                    <td>{{report.itemRate}}</td>
                    <td>{{report.itemAmount}}</td>
                    <td>{{report.totalAmount}}</td>
                    <td>{{report.pono}}</td>
                    <td>{{report.inwardNo}}</td>
                    <td>{{report.inwardDate}}</td>
                    <td>{{report.invno}}</td>
                    <td>{{report.invDate}}</td>
                    <td>{{report.dcNo}}</td>
                    <td>{{report.dcDate}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>


<p-panel header="Stock Issue Register" class="Tabledata" *ngIf="type=='stock-issue-register' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="15%">Issue No</th>
                <th width="20%">Issue Date</th>
                <th width="20%">Item Code</th>
                <th width="30%">Item Desc</th>
                <th width="15%">Issue Qty</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <td>{{report.transactionNO}}</td>
                    <td>{{report.transactionDate|date:'dd/MM/yyyy'}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemDesc}}</td>
                    <td>{{report.itemQty}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>

<p-panel header="StockItem Details Report" class="Tabledata" *ngIf="type=='stockitem-details-report'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <!-- <th width="10%">Date</th> -->
                <th width="25%">DOC No</th>
                <th width="10%">DOC Date</th>
                <th width="20%">Trans Type</th>
                <th width="10%">Inward Qty</th>
                <th width="10%">Outward Qty</th>
                <th width="10%">Closing Qty</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <!-- <td>{{report.transDate | date:'dd/MM/yyyy'}}</td> -->
                    <td>{{report.transDocNo}}</td>
                    <td>{{report.transDate}}</td>
                    <td>{{report.transType}}</td>
                    <td>{{report.inwardQty}}</td>
                    <td>{{report.outwardQty}}</td>
                    <td>{{report.closingQty}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>

<p-panel header="Batch Details Report" class="Tabledata" *ngIf="type=='batch-details-report' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="5%">SR No</th>
                <th width="15%">Item Code</th>
                <th width="10%">Batch No</th>
                <th width="20%">Inward No</th>
                <th width="15%">Inward Date</th>
                <th width="20%">Outward No</th>
                <th width="15%">Outward Date</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList| paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
                    <td>{{report.rno }}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.batchNo}}</td>
                    <td>{{report.inwardNo}}</td>
                    <td>{{report.inWardDate}}</td>
                    <td>{{report.outwardNo}}</td>
                    <td>{{report.outwardDate}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
        <div style="text-align: center;margin: 10px;padding: 10px;">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</p-panel>
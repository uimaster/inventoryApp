<p-progressSpinner *ngIf="showLoader"></p-progressSpinner>
<app-reports-filter></app-reports-filter>

<p-panel header="PO Report" class="Tabledata" *ngIf="type=='po-report' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="8%">PO No</th>
                <th width="8%">PO Date</th>
                <th width="10%">Supplier</th>
                <th width="7%">Item Code</th>
                <th width="20%">Item Desc</th>
                <th width="5%">Item Qty</th>
                <th width="8%">Pending Qty</th>
                <th width="5%">Rate</th>
                <th width="5%">Amount</th>
                <th width="8%">Total Amount</th>
                <th width="8%">Due Date</th>
                <th width="8%">Status</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList; index as i;">
                    <td>{{report.pono}}</td>
                    <td>{{report.poDate | date:'dd/MM/yyyy'}}</td>
                    <td>{{report.supplierName}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemDesc}}</td>
                    <td>{{report.itemQty}}</td>
                    <td>{{report.pendingQty}}</td>
                    <td>{{report.itemRate}}</td>
                    <td>{{report.itemAmount}}</td>
                    <td>{{report.totalAmount}}</td>
                    <td>{{ formatDate(report.poDueDate)}}</td>
                    <td>
                        <span *ngIf="report.trstatus == 1"><i style="color:orange" class="fa fa-clock-o fa-2x"></i></span>
                        <span *ngIf="report.trstatus == 2"><i style="color:green" class="fa fa-check-square-o fa-2x"></i></span>
                    </td>
                </tr>
            </ng-container>
            </tbody>
        </table>
    </div>
</p-panel>

<p-panel header="SO Report" class="Tabledata" *ngIf="type=='so-report' && sub_type=='pending-list' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="10%">SO No</th>
                <th width="15%">SO Date</th>
                <th width="20%">Customer</th>
                <th width="10%">Commission No</th>
                <th width="10%">PO No</th>
                <th width="10%">Total Amount</th>
                <th width="15%">Due Date</th>
                <th width="10%">Status</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList; index as i;">
                    <td>{{report.sono}}</td>
                    <td>{{report.soDate | date:'dd/MM/yyyy'}}</td>
                    <td>{{report.customerName}}</td>
                    <td>{{report.commissionNO}}</td>
                    <td>{{report.pono}}</td>
                    <td>{{report.totalAmount}}</td>
                    <td>{{report.soDueDate}}</td>
                    <td>
                        <span *ngIf="report.trstatus == 1"><i style="color:orange" class="fa fa-clock-o fa-2x"></i></span>
                        <span *ngIf="report.trstatus == 2"><i style="color:green" class="fa fa-check-square-o fa-2x"></i></span>
                    </td>
                </tr>
            </ng-container>
            </tbody>
        </table>
    </div>
</p-panel>

<p-panel header="SO Details Report" class="Tabledata" *ngIf="type=='so-report' && sub_type=='sales-order-details' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%"  type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="5%">Order No</th>
                <th width="5%">Date</th>
                <th width="5%">PO No</th>
                <th width="5%">JOB NO</th>
                <th width="5%">Item Code</th>
                <th width="16%">Description</th>
                <th width="3%">Qty</th>
                <th width="3%">UOM</th>
                <th width="3%">Length</th>
                <th width="5%">Rate</th>
                <th width="5%">Amount</th>
                <th width="5%">Order Amount</th>
                <th width="5%">Due Date</th>
                <th width="15%">Customer</th>
                <th width="10%">Despatch Location</th>
                <th width="5%">Status</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList; index as i;">
                    <td>{{report.sono}}</td>
                    <td>{{report.soDate | date:'dd/MM/yyyy'}}</td>
                    <td>{{report.pono}}</td>
                    <td>{{report.jobno}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemDesc}}</td>
                    <td>{{report.itemQty}}</td>
                    <td>{{report.uom}}</td>
                    <td>{{report.itemLength}}</td>
                    <td>{{report.itemRate}}</td>
                    <td>{{report.itemAmount}}</td>
                    <td>{{report.totalAmount}}</td>
                    <td>{{report.soDueDate}}</td>
                    <td>{{report.customerName}}</td>
                    <td>{{report.customerLocation}}</td>
                    <td>
                        <span *ngIf="report.trstatus == 1"><i style="color:orange" class="fa fa-clock-o fa-2x"></i></span>
                        <span *ngIf="report.trstatus == 2"><i style="color:green" class="fa fa-check-square-o fa-2x"></i></span>
                    </td>
                </tr>
            </ng-container>
            </tbody>
        </table>
    </div>
</p-panel>

<p-panel header="Despatch Details Report" class="Tabledata" *ngIf="type=='despatch-details-report' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="5%">DOC No</th>
                <th width="5%">Date</th>
                <th width="5%">PO No</th>
                <th width="5%">PO Date</th>
                <th width="5%">JOB NO</th>
                <th width="5%">Item Code</th>
                <th width="15%">Description</th>
                <th width="5%">Qty</th>
                <th width="5%">Stops</th>
                <th width="5%">UOM</th>
                <th width="15%">Customer</th>
                <th width="10%">Despatch Location</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList; index as i;">
                    <td>{{report.plno}}</td>
                    <td>{{report.plDate | date:'dd/MM/yyyy'}}</td>
                    <td>{{report.pono}}</td>
                    <td>{{report.poDate}}</td>
                    <td>{{report.jobno}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemDesc}}</td>
                    <td>{{report.itemQty}}</td>
                    <td>{{report.itemStops}}</td>
                    <td>{{report.itemUOM}}</td>
                    <td>{{report.customerName}}</td>
                    <td>{{report.customerLocation}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
    </div>
</p-panel>

<p-panel header="Stock Summary" class="Tabledata" *ngIf="type=='stock-summary' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div ><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="5%">SNo</th>
                <th width="10%">Item Code</th>
                <th width="20%">Item Name</th>
                <th width="10%">OpBal</th>
                <th width="5%">GRN Qty</th>
                <th width="10%">Purchase Rtn</th>
                <th width="5%">Stock Issue Qty</th>
                <th width="10%">Sales Qty</th>
                <th width="10%">Closing Qty</th>
                <th width="10%">Closing Rate</th>
                <th width="10%">Closing Value</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList; index as i;">
                    <td>{{i+1}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemName}}</td>
                    <td>{{report.opBalQty}}</td>
                    <td>{{report.grnQty}}</td>
                    <td>{{report.purchaseReturnQty}}</td>
                    <td>{{report.stockIssueQty}}</td>
                    <td>{{report.salesQty}}</td>
                    <td>{{report.closingQty}}</td>
                    <td></td>
                    <td></td>
                </tr>
            </ng-container>
            </tbody>
        </table>
    </div>
</p-panel>

<p-panel header="MSL Report" class="Tabledata" *ngIf="type=='msl-report' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
        
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="10%">SNo</th>
                <th width="20%">Item Code</th>
                <th width="30%">Item Name</th>
                <th width="20%">MSL Qty</th>
                <th width="20%">Closing Qty</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList; index as i;">
                    <td>{{i+1}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemName}}</td>
                    <td>{{report.mslQty}}</td>
                    <td>{{report.currentSTKQty}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
    </div>
</p-panel>

<p-panel header="Sales Register" class="Tabledata" *ngIf="type=='sales-register' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    

    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="10%">SNo</th>
                <th width="10%">Invoice Number</th>
                <th width="10%">Invoice Date</th>
                <th width="20%">Customer Name</th>
                <th width="10%">Total Amount</th>
                <th width="10%">Commission No</th>
                <th width="10%">PO No</th>
                <th width="10%">EWayBillNo</th>
                <th width="10%">EwayBillDate</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList; index as i;">
                    <td>{{i+1}}</td>
                    <td>{{report.transactionNO}}</td>
                    <td>{{report.transactionDate|date:'dd/MM/yyyy'}}</td>
                    <td>{{report.customerName}}</td>
                    <td>{{report.totalAmount}}</td>
                    <td></td>
                    <td>{{report.pono}}</td>
                    <td>{{report.eWayBillNo}}</td>
                    <td>{{report.eWayBillDate|date:'dd/MM/yyyy'}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
    </div>
</p-panel>


<p-panel header="GRN Register" class="Tabledata" *ngIf="type=='grn-register' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    

    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="10%">GRN No</th>
                <th width="10%">GRN Date</th>
                <th width="15%">Supplier</th>
                <th width="10%">Item Code</th>
                <th width="15%">Item Desc</th>
                <th width="10%">Order Qty</th>
                <th width="5%">Received Qty</th>
                <th width="5%">Rate</th>
                <th width="5%">Amount</th>
                <th width="5%">Total Amount</th>
                <th width="10%">PO No</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList; index as i;">
                    <td>{{report.transactionNO}}</td>
                    <td>{{report.transactionDate|date:'dd/MM/yyyy'}}</td>
                    <td>{{report.supplierName}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemDesc}}</td>
                    <td>{{report.orderqty}}</td>
                    <td>{{report.itemQty}}</td>
                    <td>{{report.itemRate}}</td>
                    <td>{{report.itemAmount}}</td>
                    <td>{{report.totalAmount}}</td>
                    <td>{{report.pono}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
    </div>
</p-panel>


<p-panel header="Stock Issue Register" class="Tabledata" *ngIf="type=='stock-issue-register' && filter =='true'">
    <p-header>
        <button pButton type="button" style="float:right" icon="fa fa-file-excel-o" label="Export" class="ui-button-success" (click)="exportAsXLSX()"></button>
    </p-header>
    <div class="ui-g"><div class="ui-g-12"><div><span class="ui-float-label"><input style="width:100%" type="text" pInputText placeholder="Search.." (keyup)="applyFilter($event.target.value)"></span></div></div></div>    
    <div class="table-responsive">
        <table class="table">
            <thead>
            <tr>
                <th width="15%">Issue No</th>
                <th width="20%">Issue Date</th>
                <th width="20%">Item Code</th>
                <th width="30%">Item Desc</th>
                <th width="15%">Issue Qty</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngIf="reportsList">
                <tr *ngFor="let report of reportsList; index as i;">
                    <td>{{report.transactionNO}}</td>
                    <td>{{report.transactionDate|date:'dd/MM/yyyy'}}</td>
                    <td>{{report.itemCode}}</td>
                    <td>{{report.itemDesc}}</td>
                    <td>{{report.itemQty}}</td>
                </tr>
            </ng-container>
            </tbody>
        </table>
    </div>
</p-panel>